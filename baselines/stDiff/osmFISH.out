nohup: ignoring input
INFO:root:26 training genes are saved in `uns``training_genes` of both single cell and spatial Anndatas.
INFO:root:26 overlapped genes are saved in `uns``overlap_genes` of both single cell and spatial Anndatas.
INFO:root:uniform based density prior is calculated and saved in `obs``uniform_density` of the spatial Anndata.
INFO:root:rna count based density prior is calculated and saved in `obs``rna_count_based_density` of the spatial Anndata.
INFO:root:Allocate tensors for mapping.
INFO:root:Begin training with 26 genes and rna_count_based density_prior in clusters mode...
INFO:root:Printing scores every 100 epochs.
INFO:root:Saving results..
adata_spatial:  /home/maninder/code_model_training/data/processedData/osmFISH/spatial.h5ad
adata_seq:  /home/maninder/code_model_training/data/processedData/osmFISH/scRNA_common.h5ad
sp shape (3405, 33)
sc shape (1691, 33)
The number of common genes:: 33
sp_data: (3405, 33), sc_data: (1691, 33)
sp_idx_test: [ 291  736 2098  432  479  764  501 2949 1615 2103 3357  551 1614 1740
 3384  621 1138 2195 1272  170 2947  229 1778 1611  847 1366  298 2270
  144 2942   32 1406 2955   51 1412 2713  840 1392 2353 2649  393  183
 3240 3117 2547 1322   70  257  239 3294 1545  927 1106 3329 1651 2372
  812 1091 2742 2891 1253  299 2315  964 1135  765  871  184 2595   52
 2818 3303 1945 3310 1656 2599 3137  295 1011  787 3128 2670 1061   17
 1073 2554 1767  315 2381 1444 3126 1929 1001 2496 2466 2242 2871 2196
 2726 1022   26 2872 1003  238  321  414 2345  817  486 3160  322 2697
 3383   30 1270 1462  203 1114 1175  139  134  670 2585 1298 2517 3199
  785 1104 1424 1044 2819 1499 3237 2933  457 2655 2823 3019  578 2543
  192 1231 2288 2994 2453  557  567 1714 1721 2785  439  794  756 3086
  314 3153 1694 3207 1641 1251 1457 1220  761  450  907 2741 3031 1362
 1173 2653  839 1866   80 3027 1791   93 2478  742 1660 1510 1034 1422
 2379 2292 1937 2996 1436  358  693  194 1532  781 2421 1467 2488 1399
 2998 2189 1941  166 2477  642  857 3063 2033  897 1123 1706 1826 3400
  402 2764 2621 2023 1503 2834 1057 3302 1356 1666 2762  174  527 2623
  309 2659 3286 1590  196 2483  102 3042 3248  881 3285 3175 3030 2692
  952  289 1105 2967  443 2157  705   44 2850 3367   76  442 1146  831
 2348 2978 1286 1006 1459 3394  506  942 1644 2958 3215 1874 1089 3345
 2634 3262  279 2226 1637 1784 1263 2147 3067 1157  240  729 1344 1891
 1053 2408 2083 1995 1113  152 3198 1128 2354 2148  256 1465 1732  438
 2941  511 2622 2380  178 1747 3167 2022 1483 2413 1553  554  721   14
 2254  173 3200 3210  869 1725 2784  325 2798  862 1429 1509 1736  331
 3014   63  266 2800 2900  157 1940 3388  811  254 2316 2887  573  893
  124 1283  263 1746 2683 2129 1350 2159  410 2862 2600  387   88 1018
  599 1414 1898 1334 1766 1616 2988 2696  120 2892  478 2932 2384 1684
  596  962  976  544  274  109 1064  997  214 1370 3133 1161  594 3336
  368 1727 3271  802 2868 2194  461 1330 1752  818 2687   45  985 2583
 3368  218 1600 2732 1927 1882  564 3249  332  251  354 1613 2971  691
 2374 3296 3205  612 2069 2672 1052 1703 1385 1659  408 2462 1718 2760
  678 1315 2177    0 3195 2667 3275 3356 1860 1025  463  423 3179  495
 2411 1849  211 1288 1226  346  270 1840 2431 1336 3012  838  149  602
  175  278 1338 2262  610 1029 3217 2118 2167   33  179 3064  416 3079
 1964  247 1454 2215 1151 2329 1675 1295 1765 1873  859 2855 1979 1720
  430  449 3328 1133 1626 3151 1606 1116  433 3081  371 2802 2037  538
  188 1709 1468  903 2515 1775 1951 3221 1373  810 2371 2113  324 2991
  798  246   58 2005 1961 1340  411 1289 2256 3110  712 3196 2140 2719
  657 2468  790 2533  485 1877 2748 1960 3096 2260 2876 2677 2465 1783
 2019  842 1667 3120 1702  296  809  507 2328 2620 3087 1565 3140  605
 3282 2724 3209 1255 2002 1027 1110 1080   25 1404 3037 1592  937 2015
 1650   67 2607 2401 1538 1425  929   31  905 2471 1867 3228  343 1397
 3403 2795 3392  776 1261 2440 2279 2202 2285 2457 2447 1894  528  176
  422  949 2562 3362 3323  676 1889  288 2548 1754  177 1745 2073 1271
 1411  370 1665  598 2251  665 1837 2674 1992 1456 2436  141 2645 2164
 1697  471  940 2271 1234  755 1047  195  532 1918 3074 3036 2624 2501
  555 1952 2582 1835  889  679  631 1474  654  162 2626 1421  864 3129
  945  547 2813 1681  568  718 3299 2216  611 2992 3125 1525 1728 1067
  680  581 2552 1723   73   48 3166 3260 2867 3041 1844 1963 1991 1378
 3317 1461 1419 2458  572 3244 2077 3232 1192]
scRNA split -> Train: (2724, 33), Test: (681, 33)
We run SpaGE for this data


===== Fold 1 =====
Number of train genes: 26, Number of test genes: 7
gene_seq:: [['ANLN', 'FOXJ1', 'LAMP5', 'PDGFRA', 'SERPINF1', 'SLC32A1', 'SOX10']]
{'pearson_mean': 0.1483, 'spearman_mean_genewise': 0.1734, 'l1_error_mean': 3.2963, 'l2_errors_mean': 15.3255, 'r2_scores_mean': -1.9612, 'pearson_std': 0.1536, 'l2_error_q1': 11.8989, 'l2_error_q2': 14.8934, 'l2_error_q3': 18.2734, 'r2_score_q1': -2.3624, 'r2_score_q2': -2.0648, 'r2_score_q3': -1.1609, 'fold': 1, 'phase': 'val', 'loss': 15.3255}
[Fold 1] SpaGE val Spearman: 0.1734, Pearson: 0.1483

===== Fold 2 =====
Number of train genes: 26, Number of test genes: 7
gene_seq:: [['ANLN', 'FOXJ1', 'LAMP5', 'PDGFRA', 'SERPINF1', 'SLC32A1', 'SOX10'], ['CRHBP', 'FLT1', 'ITPR2', 'KCNIP2', 'RORB', 'TMEM2', 'VTN']]
{'pearson_mean': 0.1677, 'spearman_mean_genewise': 0.1689, 'l1_error_mean': 2.8906, 'l2_errors_mean': 12.6772, 'r2_scores_mean': -1.732, 'pearson_std': 0.0993, 'l2_error_q1': 7.7793, 'l2_error_q2': 12.5545, 'l2_error_q3': 13.202, 'r2_score_q1': -1.3863, 'r2_score_q2': -0.6064, 'r2_score_q3': -0.3697, 'fold': 2, 'phase': 'val', 'loss': 12.6772}
[Fold 2] SpaGE val Spearman: 0.1689, Pearson: 0.1677

===== Fold 3 =====
Number of train genes: 26, Number of test genes: 7
gene_seq:: [['ANLN', 'FOXJ1', 'LAMP5', 'PDGFRA', 'SERPINF1', 'SLC32A1', 'SOX10'], ['CRHBP', 'FLT1', 'ITPR2', 'KCNIP2', 'RORB', 'TMEM2', 'VTN'], ['ALDOC', 'CNR1', 'GFAP', 'HEXB', 'PTHLH', 'TBR1', 'TTR']]
{'pearson_mean': 0.1204, 'spearman_mean_genewise': 0.1338, 'l1_error_mean': 3.1931, 'l2_errors_mean': 13.9845, 'r2_scores_mean': -3.7727, 'pearson_std': 0.1401, 'l2_error_q1': 11.6775, 'l2_error_q2': 12.7794, 'l2_error_q3': 15.7461, 'r2_score_q1': -2.9002, 'r2_score_q2': -1.6344, 'r2_score_q3': -1.301, 'fold': 3, 'phase': 'val', 'loss': 13.9845}
[Fold 3] SpaGE val Spearman: 0.1338, Pearson: 0.1204

===== Fold 4 =====
Number of train genes: 27, Number of test genes: 6
gene_seq:: [['ANLN', 'FOXJ1', 'LAMP5', 'PDGFRA', 'SERPINF1', 'SLC32A1', 'SOX10'], ['CRHBP', 'FLT1', 'ITPR2', 'KCNIP2', 'RORB', 'TMEM2', 'VTN'], ['ALDOC', 'CNR1', 'GFAP', 'HEXB', 'PTHLH', 'TBR1', 'TTR'], ['BMP4', 'CPNE5', 'GAD2', 'MFGE8', 'MRC1', 'PLP1']]
{'pearson_mean': 0.1869, 'spearman_mean_genewise': 0.2046, 'l1_error_mean': 3.1151, 'l2_errors_mean': 14.3911, 'r2_scores_mean': -2.2996, 'pearson_std': 0.1303, 'l2_error_q1': 10.3454, 'l2_error_q2': 15.0227, 'l2_error_q3': 19.5803, 'r2_score_q1': -4.204, 'r2_score_q2': -1.6153, 'r2_score_q3': -0.6222, 'fold': 4, 'phase': 'val', 'loss': 14.3911}
[Fold 4] SpaGE val Spearman: 0.2046, Pearson: 0.1869

===== Fold 5 =====
Number of train genes: 27, Number of test genes: 6
gene_seq:: [['ANLN', 'FOXJ1', 'LAMP5', 'PDGFRA', 'SERPINF1', 'SLC32A1', 'SOX10'], ['CRHBP', 'FLT1', 'ITPR2', 'KCNIP2', 'RORB', 'TMEM2', 'VTN'], ['ALDOC', 'CNR1', 'GFAP', 'HEXB', 'PTHLH', 'TBR1', 'TTR'], ['BMP4', 'CPNE5', 'GAD2', 'MFGE8', 'MRC1', 'PLP1'], ['ACTA2', 'APLN', 'CRH', 'CTPS', 'SYT6', 'VIP']]
{'pearson_mean': 0.1284, 'spearman_mean_genewise': 0.1218, 'l1_error_mean': 3.1122, 'l2_errors_mean': 13.4172, 'r2_scores_mean': -2.1768, 'pearson_std': 0.1294, 'l2_error_q1': 13.6631, 'l2_error_q2': 14.1352, 'l2_error_q3': 14.6556, 'r2_score_q1': -2.2252, 'r2_score_q2': -1.8476, 'r2_score_q3': -1.0487, 'fold': 5, 'phase': 'val', 'loss': 13.4172}
[Fold 5] SpaGE val Spearman: 0.1218, Pearson: 0.1284
Saved all fold metrics to Result/osmFISHBaseline_new/spage/fold_results/fold_metrics.csv
Saved mean and std metrics to Result/osmFISHBaseline_new/spage/fold_results/metrics_summary.csv
all_pred_res :::: (681, 33)
Result/osmFISHBaseline_new//SpaGE_impute.csv
We run Tangram for this data


===== Fold 1 =====
Number of train genes: 26, Number of test genes: 7
Score: 0.682, KL reg: 0.080
Score: 0.914, KL reg: 0.001
Score: 0.915, KL reg: 0.001
Score: 0.916, KL reg: 0.001
Score: 0.916, KL reg: 0.001
Score: 0.916, KL reg: 0.001
Score: 0.916, KL reg: 0.001
Score: 0.916, KL reg: 0.001
Score: 0.916, KL reg: 0.001
Score: 0.916, KL reg: 0.001
{'fold': 1, 'phase': 'val', 'loss': 18.3864, 'pearson_mean': 0.1871, 'spearman_mean_genewise': 0.1729, 'l1_error_mean': 3.6098, 'l2_errors_mean': 18.3864, 'r2_scores_mean': -2.4942, 'pearson_std': 0.1018, 'l2_error_q1': 13.8379, 'l2_error_q2': 16.3072, 'l2_error_q3': 20.4294, 'r2_score_q1': -3.5511, 'r2_score_q2': -2.4019, 'r2_score_q3': -1.2366}
INFO:root:26 training genes are saved in `uns``training_genes` of both single cell and spatial Anndatas.
INFO:root:26 overlapped genes are saved in `uns``overlap_genes` of both single cell and spatial Anndatas.
INFO:root:uniform based density prior is calculated and saved in `obs``uniform_density` of the spatial Anndata.
INFO:root:rna count based density prior is calculated and saved in `obs``rna_count_based_density` of the spatial Anndata.
INFO:root:Allocate tensors for mapping.
INFO:root:Begin training with 26 genes and rna_count_based density_prior in clusters mode...
INFO:root:Printing scores every 100 epochs.
INFO:root:Saving results..
INFO:root:26 training genes are saved in `uns``training_genes` of both single cell and spatial Anndatas.
INFO:root:26 overlapped genes are saved in `uns``overlap_genes` of both single cell and spatial Anndatas.
INFO:root:uniform based density prior is calculated and saved in `obs``uniform_density` of the spatial Anndata.
INFO:root:rna count based density prior is calculated and saved in `obs``rna_count_based_density` of the spatial Anndata.
INFO:root:Allocate tensors for mapping.
INFO:root:Begin training with 26 genes and rna_count_based density_prior in clusters mode...
INFO:root:Printing scores every 100 epochs.
INFO:root:Saving results..
INFO:root:27 training genes are saved in `uns``training_genes` of both single cell and spatial Anndatas.
INFO:root:27 overlapped genes are saved in `uns``overlap_genes` of both single cell and spatial Anndatas.
INFO:root:uniform based density prior is calculated and saved in `obs``uniform_density` of the spatial Anndata.
INFO:root:rna count based density prior is calculated and saved in `obs``rna_count_based_density` of the spatial Anndata.
INFO:root:Allocate tensors for mapping.
INFO:root:Begin training with 27 genes and rna_count_based density_prior in clusters mode...
INFO:root:Printing scores every 100 epochs.
INFO:root:Saving results..
INFO:root:27 training genes are saved in `uns``training_genes` of both single cell and spatial Anndatas.
INFO:root:27 overlapped genes are saved in `uns``overlap_genes` of both single cell and spatial Anndatas.
INFO:root:uniform based density prior is calculated and saved in `obs``uniform_density` of the spatial Anndata.
INFO:root:rna count based density prior is calculated and saved in `obs``rna_count_based_density` of the spatial Anndata.
INFO:root:Allocate tensors for mapping.
INFO:root:Begin training with 27 genes and rna_count_based density_prior in clusters mode...
INFO:root:Printing scores every 100 epochs.
INFO:root:Saving results..
[Fold 1] Spearman: 0.1729, Pearson: 0.1871, L2 loss: 18.3864

===== Fold 2 =====
Number of train genes: 26, Number of test genes: 7
Score: 0.703, KL reg: 0.080
Score: 0.919, KL reg: 0.001
Score: 0.921, KL reg: 0.001
Score: 0.921, KL reg: 0.001
Score: 0.921, KL reg: 0.001
Score: 0.921, KL reg: 0.001
Score: 0.921, KL reg: 0.001
Score: 0.921, KL reg: 0.001
Score: 0.921, KL reg: 0.001
Score: 0.921, KL reg: 0.001
{'fold': 2, 'phase': 'val', 'loss': 15.3104, 'pearson_mean': 0.2356, 'spearman_mean_genewise': 0.192, 'l1_error_mean': 3.0547, 'l2_errors_mean': 15.3104, 'r2_scores_mean': -2.304, 'pearson_std': 0.1085, 'l2_error_q1': 9.1, 'l2_error_q2': 13.5036, 'l2_error_q3': 16.8186, 'r2_score_q1': -1.7216, 'r2_score_q2': -1.1669, 'r2_score_q3': -0.6081}
[Fold 2] Spearman: 0.1920, Pearson: 0.2356, L2 loss: 15.3104

===== Fold 3 =====
Number of train genes: 26, Number of test genes: 7
Score: 0.678, KL reg: 0.088
Score: 0.911, KL reg: 0.001
Score: 0.913, KL reg: 0.001
Score: 0.913, KL reg: 0.001
Score: 0.913, KL reg: 0.001
Score: 0.913, KL reg: 0.001
Score: 0.913, KL reg: 0.001
Score: 0.913, KL reg: 0.001
Score: 0.913, KL reg: 0.001
Score: 0.914, KL reg: 0.001
{'fold': 3, 'phase': 'val', 'loss': 18.625, 'pearson_mean': 0.1716, 'spearman_mean_genewise': 0.1381, 'l1_error_mean': 3.733, 'l2_errors_mean': 18.625, 'r2_scores_mean': -5.707, 'pearson_std': 0.0935, 'l2_error_q1': 14.228, 'l2_error_q2': 18.0767, 'l2_error_q3': 20.9724, 'r2_score_q1': -4.5981, 'r2_score_q2': -3.082, 'r2_score_q3': -1.4731}
[Fold 3] Spearman: 0.1381, Pearson: 0.1716, L2 loss: 18.6250

===== Fold 4 =====
Number of train genes: 27, Number of test genes: 6
Score: 0.685, KL reg: 0.083
Score: 0.923, KL reg: 0.001
Score: 0.924, KL reg: 0.001
Score: 0.925, KL reg: 0.001
Score: 0.925, KL reg: 0.001
Score: 0.925, KL reg: 0.001
Score: 0.925, KL reg: 0.001
Score: 0.925, KL reg: 0.001
Score: 0.925, KL reg: 0.001
Score: 0.925, KL reg: 0.001
{'fold': 4, 'phase': 'val', 'loss': 15.3671, 'pearson_mean': 0.2286, 'spearman_mean_genewise': 0.1943, 'l1_error_mean': 3.2545, 'l2_errors_mean': 15.3671, 'r2_scores_mean': -2.6402, 'pearson_std': 0.1104, 'l2_error_q1': 8.078, 'l2_error_q2': 15.7795, 'l2_error_q3': 21.0534, 'r2_score_q1': -4.5194, 'r2_score_q2': -1.6114, 'r2_score_q3': -0.5679}
[Fold 4] Spearman: 0.1943, Pearson: 0.2286, L2 loss: 15.3671

===== Fold 5 =====
Number of train genes: 27, Number of test genes: 6
Score: 0.705, KL reg: 0.078
Score: 0.912, KL reg: 0.001
Score: 0.913, KL reg: 0.001
Score: 0.914, KL reg: 0.001
Score: 0.914, KL reg: 0.001
Score: 0.914, KL reg: 0.001
Score: 0.914, KL reg: 0.001
Score: 0.914, KL reg: 0.001
Score: 0.914, KL reg: 0.001
Score: 0.914, KL reg: 0.001
{'fold': 5, 'phase': 'val', 'loss': 16.5114, 'pearson_mean': 0.1637, 'spearman_mean_genewise': 0.1261, 'l1_error_mean': 3.4388, 'l2_errors_mean': 16.5114, 'r2_scores_mean': -3.1533, 'pearson_std': 0.1223, 'l2_error_q1': 15.2105, 'l2_error_q2': 16.4389, 'l2_error_q3': 17.9671, 'r2_score_q1': -3.0915, 'r2_score_q2': -2.1567, 'r2_score_q3': -1.2418}
[Fold 5] Spearman: 0.1261, Pearson: 0.1637, L2 loss: 16.5114
Saved all fold metrics to Result/osmFISHBaseline_new/tangram/fold_results/fold_metrics.csv
Saved mean and std metrics to Result/osmFISHBaseline_new/tangram/fold_results/metrics_summary.csv
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
outdir1: Result/osmFISHBaseline_new/stplus

===== Fold 1 =====
Number of train genes: 26, Number of test genes: 7
Models will be saved in: Result/osmFISHBaseline_new/process_file/stPlus-demo-5min*.pt

Spatial transcriptomics data: 3405 cells * 26 genes
Reference scRNA-seq data:     1691 cells * 33 genes
7 genes to be predicted

Start initialization
⚙️  Selected physical GPU 1 (22.05 GB free)
Start embedding
	[1] recon_loss: 5122.494, pred_loss: 2154.647, total_loss: 7277.141
	[2] recon_loss: 3184.873, pred_loss: 1904.588, total_loss: 5089.461
	[3] recon_loss: 3155.935, pred_loss: 1824.722, total_loss: 4980.657
	[4] recon_loss: 3151.669, pred_loss: 1787.562, total_loss: 4939.232
	[5] recon_loss: 3151.051, pred_loss: 1767.553, total_loss: 4918.604
	[6] recon_loss: 3149.273, pred_loss: 1719.648, total_loss: 4868.922
	[7] recon_loss: 3148.554, pred_loss: 1707.046, total_loss: 4855.600
Start prediction
	Using model 1 to predict
	Using model 2 to predict
	Using model 3 to predict
	Using model 4 to predict
	Using model 5 to predict
stPlus_res type ++++++++++++++++++++++++++ : <class 'tuple'>
stPlus_df:  (3405, 7)
stPlus_df type:  <class 'pandas.core.frame.DataFrame'>
all_pred_res shape:  (681, 33)
my_test (681, 7)
{'fold': 1, 'phase': 'val', 'loss': 15.2374, 'pearson_mean': 0.2164, 'spearman_mean_genewise': 0.215, 'l1_error_mean': 3.2998, 'l2_errors_mean': 15.2374, 'r2_scores_mean': -1.9821, 'pearson_std': 0.1644, 'l2_error_q1': 11.8668, 'l2_error_q2': 17.1855, 'l2_error_q3': 19.2978, 'r2_score_q1': -3.1278, 'r2_score_q2': -1.9515, 'r2_score_q3': -1.1583}

===== Fold 2 =====
Number of train genes: 26, Number of test genes: 7
Models will be saved in: Result/osmFISHBaseline_new/process_file/stPlus-demo-5min*.pt

Spatial transcriptomics data: 3405 cells * 26 genes
Reference scRNA-seq data:     1691 cells * 33 genes
7 genes to be predicted

Start initialization
⚙️  Selected physical GPU 1 (22.05 GB free)
Start embedding
	[1] recon_loss: 4545.024, pred_loss: 3040.460, total_loss: 7585.484
	[2] recon_loss: 1988.427, pred_loss: 2664.366, total_loss: 4652.793
	[3] recon_loss: 1967.907, pred_loss: 2533.690, total_loss: 4501.597
	[4] recon_loss: 1965.104, pred_loss: 2434.245, total_loss: 4399.350
	[5] recon_loss: 1963.701, pred_loss: 2360.985, total_loss: 4324.686
	[6] recon_loss: 1963.957, pred_loss: 2291.964, total_loss: 4255.920
	[7] recon_loss: 1964.487, pred_loss: 2250.200, total_loss: 4214.687
	[8] recon_loss: 1964.006, pred_loss: 2197.968, total_loss: 4161.973
	[9] recon_loss: 1963.569, pred_loss: 2155.079, total_loss: 4118.648
	[10] recon_loss: 1961.747, pred_loss: 2112.196, total_loss: 4073.943
	[11] recon_loss: 1961.954, pred_loss: 2057.915, total_loss: 4019.869
	[12] recon_loss: 1963.679, pred_loss: 2042.391, total_loss: 4006.069
Start prediction
	Using model 1 to predict
	Using model 2 to predict
	Using model 3 to predict
	Using model 4 to predict
	Using model 5 to predict
stPlus_res type ++++++++++++++++++++++++++ : <class 'tuple'>
stPlus_df:  (3405, 7)
stPlus_df type:  <class 'pandas.core.frame.DataFrame'>
all_pred_res shape:  (681, 33)
my_test (681, 7)
{'fold': 2, 'phase': 'val', 'loss': 12.8064, 'pearson_mean': 0.1481, 'spearman_mean_genewise': 0.1531, 'l1_error_mean': 2.8678, 'l2_errors_mean': 12.8064, 'r2_scores_mean': -1.7324, 'pearson_std': 0.1295, 'l2_error_q1': 8.3268, 'l2_error_q2': 12.34, 'l2_error_q3': 13.7484, 'r2_score_q1': -1.4468, 'r2_score_q2': -0.6184, 'r2_score_q3': -0.4677}

===== Fold 3 =====
Number of train genes: 26, Number of test genes: 7
Models will be saved in: Result/osmFISHBaseline_new/process_file/stPlus-demo-5min*.pt

Spatial transcriptomics data: 3405 cells * 26 genes
Reference scRNA-seq data:     1691 cells * 33 genes
7 genes to be predicted

Start initialization
⚙️  Selected physical GPU 1 (22.05 GB free)
Start embedding
	[1] recon_loss: 3799.712, pred_loss: 2457.379, total_loss: 6257.091
	[2] recon_loss: 1497.016, pred_loss: 1997.803, total_loss: 3494.819
	[3] recon_loss: 1473.537, pred_loss: 1897.150, total_loss: 3370.687
	[4] recon_loss: 1469.649, pred_loss: 1841.723, total_loss: 3311.372
	[5] recon_loss: 1468.835, pred_loss: 1783.072, total_loss: 3251.907
	[6] recon_loss: 1467.318, pred_loss: 1749.745, total_loss: 3217.063
	[7] recon_loss: 1467.671, pred_loss: 1710.603, total_loss: 3178.274
	[8] recon_loss: 1465.331, pred_loss: 1656.477, total_loss: 3121.807
	[9] recon_loss: 1469.633, pred_loss: 1645.653, total_loss: 3115.286
Start prediction
	Using model 1 to predict
	Using model 2 to predict
	Using model 3 to predict
	Using model 4 to predict
	Using model 5 to predict
stPlus_res type ++++++++++++++++++++++++++ : <class 'tuple'>
stPlus_df:  (3405, 7)
stPlus_df type:  <class 'pandas.core.frame.DataFrame'>
all_pred_res shape:  (681, 33)
my_test (681, 7)
{'fold': 3, 'phase': 'val', 'loss': 12.0718, 'pearson_mean': 0.2132, 'spearman_mean_genewise': 0.2205, 'l1_error_mean': 2.9477, 'l2_errors_mean': 12.0718, 'r2_scores_mean': -3.0402, 'pearson_std': 0.0994, 'l2_error_q1': 9.5857, 'l2_error_q2': 12.2945, 'l2_error_q3': 14.7177, 'r2_score_q1': -2.47, 'r2_score_q2': -1.7028, 'r2_score_q3': -0.7374}

===== Fold 4 =====
Number of train genes: 27, Number of test genes: 6
Models will be saved in: Result/osmFISHBaseline_new/process_file/stPlus-demo-5min*.pt

Spatial transcriptomics data: 3405 cells * 27 genes
Reference scRNA-seq data:     1691 cells * 33 genes
6 genes to be predicted

Start initialization
⚙️  Selected physical GPU 1 (22.05 GB free)
Start embedding
	[1] recon_loss: 3770.939, pred_loss: 3959.297, total_loss: 7730.236
	[2] recon_loss: 858.763, pred_loss: 2580.514, total_loss: 3439.277
	[3] recon_loss: 819.173, pred_loss: 2324.938, total_loss: 3144.111
	[4] recon_loss: 804.133, pred_loss: 2162.211, total_loss: 2966.344
	[5] recon_loss: 800.051, pred_loss: 2076.803, total_loss: 2876.854
	[6] recon_loss: 799.007, pred_loss: 2006.439, total_loss: 2805.446
	[7] recon_loss: 796.768, pred_loss: 1944.738, total_loss: 2741.507
	[8] recon_loss: 797.760, pred_loss: 1931.938, total_loss: 2729.698
	[9] recon_loss: 795.886, pred_loss: 1851.640, total_loss: 2647.526
	[10] recon_loss: 797.637, pred_loss: 1834.069, total_loss: 2631.706
	[11] recon_loss: 796.071, pred_loss: 1827.768, total_loss: 2623.838
Start prediction
	Using model 1 to predict
	Using model 2 to predict
	Using model 3 to predict
	Using model 4 to predict
	Using model 5 to predict
stPlus_res type ++++++++++++++++++++++++++ : <class 'tuple'>
stPlus_df:  (3405, 6)
stPlus_df type:  <class 'pandas.core.frame.DataFrame'>
all_pred_res shape:  (681, 33)
my_test (681, 6)
{'fold': 4, 'phase': 'val', 'loss': 14.0301, 'pearson_mean': 0.2294, 'spearman_mean_genewise': 0.2574, 'l1_error_mean': 3.1174, 'l2_errors_mean': 14.0301, 'r2_scores_mean': -2.2485, 'pearson_std': 0.1455, 'l2_error_q1': 8.842, 'l2_error_q2': 14.4847, 'l2_error_q3': 18.3537, 'r2_score_q1': -3.8089, 'r2_score_q2': -1.5473, 'r2_score_q3': -0.4727}

===== Fold 5 =====
Number of train genes: 27, Number of test genes: 6
Models will be saved in: Result/osmFISHBaseline_new/process_file/stPlus-demo-5min*.pt

Spatial transcriptomics data: 3405 cells * 27 genes
Reference scRNA-seq data:     1691 cells * 33 genes
6 genes to be predicted

Start initialization
⚙️  Selected physical GPU 1 (22.05 GB free)
Start embedding
	[1] recon_loss: 2395.133, pred_loss: 4024.649, total_loss: 6419.782
	[2] recon_loss: 40.557, pred_loss: 3880.801, total_loss: 3921.358
	[3] recon_loss: 29.693, pred_loss: 3842.488, total_loss: 3872.182
	[4] recon_loss: 24.119, pred_loss: 3782.716, total_loss: 3806.835
	[5] recon_loss: 22.525, pred_loss: 3746.011, total_loss: 3768.537
	[6] recon_loss: 29.434, pred_loss: 3701.206, total_loss: 3730.640
	[7] recon_loss: 23.709, pred_loss: 3679.456, total_loss: 3703.165
	[8] recon_loss: 23.937, pred_loss: 3638.490, total_loss: 3662.426
	[9] recon_loss: 19.975, pred_loss: 3591.132, total_loss: 3611.107
	[10] recon_loss: 27.720, pred_loss: 3605.388, total_loss: 3633.109
	[11] recon_loss: 25.431, pred_loss: 3552.509, total_loss: 3577.940
	[12] recon_loss: 24.759, pred_loss: 3539.067, total_loss: 3563.826
Start prediction
	Using model 1 to predict
	Using model 2 to predict
	Using model 3 to predict
	Using model 4 to predict
	Using model 5 to predict
stPlus_res type ++++++++++++++++++++++++++ : <class 'tuple'>
stPlus_df:  (3405, 6)
stPlus_df type:  <class 'pandas.core.frame.DataFrame'>
all_pred_res shape:  (681, 33)
my_test (681, 6)
{'fold': 5, 'phase': 'val', 'loss': 12.5088, 'pearson_mean': 0.1865, 'spearman_mean_genewise': 0.1695, 'l1_error_mean': 3.0122, 'l2_errors_mean': 12.5088, 'r2_scores_mean': -1.7693, 'pearson_std': 0.1218, 'l2_error_q1': 10.2518, 'l2_error_q2': 13.0565, 'l2_error_q3': 13.7612, 'r2_score_q1': -2.4874, 'r2_score_q2': -1.7939, 'r2_score_q3': -0.9843}
Saved all fold metrics to Result/osmFISHBaseline_new/stplus/fold_results/fold_metrics.csv
Saved mean and std metrics to Result/osmFISHBaseline_new/stplus/fold_results/metrics_summary.csv
